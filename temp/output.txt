nyse
saved... /home/user/.stock_scraper/csv/stock_symbols/nyse.csv
nasdaq
saved... /home/user/.stock_scraper/csv/stock_symbols/nasdaq.csv
amex
saved... /home/user/.stock_scraper/csv/stock_symbols/amex.csv
.****sequel_helper init params
{:adapter=>"mysql2", :host=>"localhost", :client=>nil, :user=>"root", :password=>"password", :database=>"stock4_development"}
>> save to db 
DEBUGGING{:csv_params=>{:filename=>"/home/user/.stock_scraper/csv/stock_symbols/nyse.csv", :line_term_by=>"\n", :fields_term_by=>",", :fields_enclosed_by=>"\"", :skip_num_lines=>1, :local_flag=>true, :col_names=>["symbol", "company_name", "@dummy", "@dummy", "@dummy", "@dummy", "sector", "industry", "@dummy"], :set_col_names=>["exchange='NYSE'"]}, :table_name=>"stock_symbols", :table_cols=>["symbol", "company_name", "sector", "industry", "exchange"], :key_cols=>["symbol"]}
>> IMPORT CSV PARAMS
csvp {:filename=>"/home/user/.stock_scraper/csv/stock_symbols/nyse.csv", :line_term_by=>"\n", :fields_term_by=>",", :fields_enclosed_by=>"\"", :skip_num_lines=>1, :local_flag=>true, :col_names=>["symbol", "company_name", "@dummy", "@dummy", "@dummy", "@dummy", "sector", "industry", "@dummy"], :set_col_names=>["exchange='NYSE'"]}
table_cols ["symbol", "company_name", "sector", "industry", "exchange"]
key_cols ["symbol"]
D, [2014-01-09T16:02:52.643196 #7264] DEBUG -- : (0.002156s) SET @@wait_timeout = 2147483
D, [2014-01-09T16:02:52.656636 #7264] DEBUG -- : (0.001770s) SET SQL_AUTO_IS_NULL=0
D, [2014-01-09T16:02:53.191483 #7264] DEBUG -- : (0.534178s) DROP TABLE IF EXISTS `stock_symbolstemp`
D, [2014-01-09T16:02:53.552816 #7264] DEBUG -- : (0.350833s) CREATE TABLE stock_symbolstemp LIKE stock_symbols;
>> CLONING TABLE stock_symbols t stock_symbolstemp
SKIPLINENUM 1 true
>> gen_str [LOAD DATA INFILE '/home/user/.stock_scraper/csv/stock_symbols/nyse.csv' INTO TABLE stock_symbolstemp FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '
' IGNORE 1 LINES (symbol, company_name, @dummy, @dummy, @dummy, @dummy, sector, industry, @dummy) SET exchange='NYSE';]
D, [2014-01-09T16:02:53.943509 #7264] DEBUG -- : (0.369623s) LOAD DATA INFILE '/home/user/.stock_scraper/csv/stock_symbols/nyse.csv' INTO TABLE stock_symbolstemp FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '
' IGNORE 1 LINES (symbol, company_name, @dummy, @dummy, @dummy, @dummy, sector, industry, @dummy) SET exchange='NYSE';
>> LOAD DATA 
array length1
1st<<<<<<<<<<<<<<<<1
["symbol"]
symbol
>>>>>>>>>>>>>>>>
1st<<<<<<<<<<<<<<<<2
["symbol"]
symbol
>>>>>>>>>>>>>>>>
2nd<<<<<<<<<<<<<<<<
["symbol"]

>>>>>>>>>>>>>>>>
first
2+1
2nd<<<<<<<<<<<<<<<<
["symbol"]

>>>>>>>>>>>>>>>>
3+1
2++2
>> gen_str [INSERT INTO stock_symbols (symbol, company_name, sector, industry, exchange) SELECT t.symbol, t.company_name, t.sector, t.industry, t.exchange FROM stock_symbolstemp t LEFT JOIN stock_symbols o ON o.symbol=t.symbol AND o.=t. WHERE o.symbol IS NULL;]
INSERT INTO stock_symbols (symbol, company_name, sector, industry, exchange) SELECT t.symbol, t.company_name, t.sector, t.industry, t.exchange FROM stock_symbolstemp t LEFT JOIN stock_symbols o ON o.symbol=t.symbol AND o.=t. WHERE o.symbol IS NULL;
E, [2014-01-09T16:02:53.967127 #7264] ERROR -- : Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '=t. WHERE o.symbol IS NULL' at line 1: INSERT INTO stock_symbols (symbol, company_name, sector, industry, exchange) SELECT t.symbol, t.company_name, t.sector, t.industry, t.exchange FROM stock_symbolstemp t LEFT JOIN stock_symbols o ON o.symbol=t.symbol AND o.=t. WHERE o.symbol IS NULL;
F***********...*saved... csv/stock_quotes/GS.csv
......****sequel_helper init params
{:adapter=>"mysql2", :host=>"localhost", :client=>nil, :user=>"root", :password=>"password", :database=>"stock4_development"}
......................*......**{"foo"=>123, "bar"=>345, "cur_pos"=>123}
.

Pending:
  FetchYahooQuotes main fetch_all should return true
    # Temporarily disabled with xit
    # ./spec/features/main/fetch_yahoo_quotes_spec.rb:8
  FetchYahooQuotes misc create_url GS
    # Temporarily disabled with xit
    # ./spec/features/main/fetch_yahoo_quotes_spec.rb:18
  FetchYahooQuotes test hello returns true
    # Temporarily disabled with xit
    # ./spec/features/main/fetch_yahoo_quotes_spec.rb:29
  SaveStockSymbols main save_all_to_db basic
    # Temporarily disabled with xit
    # ./spec/features/main/save_stock_symbols_spec.rb:8
  SaveYahooQuotes main save_all_to_db basic
    # Temporarily disabled with xit
    # ./spec/features/main/save_yahoo_quotes_spec.rb:8
  SaveYahooQuotes main save_to_db AAPL
    # Temporarily disabled with xit
    # ./spec/features/main/save_yahoo_quotes_spec.rb:17
  ScrapeNasdaqSymbols scrape_to_csv returns true
    # Temporarily disabled with xit
    # ./spec/features/main/scrape_nasdaq_symbols_spec.rb:12
  ScrapeNasdaqSymbols test hello returns true
    # Temporarily disabled with xit
    # ./spec/features/main/scrape_nasdaq_symbols_spec.rb:20
  ScrapeWikiSP500 test hello returns true
    # Temporarily disabled with xit
    # ./spec/features/main/scrape_wiki_sp500_spec.rb:12
  ScrapeWikiSP500 main visit_and_parse should be true
    # Temporarily disabled with xit
    # ./spec/features/main/scrape_wiki_sp500_spec.rb:24
  ScrapeYahooPrices test hello returns true
    # Temporarily disabled with xit
    # ./spec/features/main/scrape_yahoo_prices_spec.rb:12
  ScrapeYahooPrices main visit_and_get_csv should contain GS
    # Temporarily disabled with xit
    # ./spec/features/main/scrape_yahoo_prices_spec.rb:24
  ScrapeYahooPrices main save_to_db should contain GS
    # Temporarily disabled with xit
    # ./spec/features/main/scrape_yahoo_prices_spec.rb:35
  ScrapeYahooPrices main csv_to_db should contain GS
    # Temporarily disabled with xit
    # ./spec/features/main/scrape_yahoo_prices_spec.rb:48
  ScrapeYahooPrices util create_url should contain GS
    # Temporarily disabled with xit
    # ./spec/features/main/scrape_yahoo_prices_spec.rb:61
  CsvUtil fetch_csv_from_url basic
    # Temporarily disabled with xit
    # ./spec/features/util/csv_util_spec.rb:37
  ScrapeUtil has_content_and? links on the bottom of page should return true
    # Temporarily disabled with xit
    # ./spec/features/util/scrape_util_spec.rb:15
  ScrapeUtil has_content_and? gibberish should return false
    # Temporarily disabled with xit
    # ./spec/features/util/scrape_util_spec.rb:24
  ScrapeUtil has_content_or? link on the bottom should be true
    # Temporarily disabled with xit
    # ./spec/features/util/scrape_util_spec.rb:35
  ScrapeUtil has_content_or? gibberish should be false
    # Temporarily disabled with xit
    # ./spec/features/util/scrape_util_spec.rb:45
  ValidUtil valid_date invalid 20130101111
    # Temporarily disabled with xit
    # ./spec/features/util/valid_util_spec.rb:130
  YamlUtil read cur_pos exist
    # Temporarily disabled with xit
    # ./spec/features/util/yaml_util_spec.rb:11
  YamlUtil write cur_pos updates
    # Temporarily disabled with xit
    # ./spec/features/util/yaml_util_spec.rb:18

Failures:

  1) SaveStockSymbols main save_to_db basic
     Failure/Error: result = s.save_to_db(exchange, filename)
     Sequel::DatabaseError:
       Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '=t. WHERE o.symbol IS NULL' at line 1
     # ./src/main/save_stock_symbols.rb:117:in `save_to_db'
     # ./spec/features/main/save_stock_symbols_spec.rb:21:in `block (4 levels) in <top (required)>'

Finished in 14.06 seconds
63 examples, 1 failure, 23 pending

Failed examples:

rspec ./spec/features/main/save_stock_symbols_spec.rb:17 # SaveStockSymbols main save_to_db basic
